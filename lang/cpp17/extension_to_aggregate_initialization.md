# é›†æˆä½“åˆæœŸåŒ–ã®æ‹¡å¼µ

* cpp17[meta cpp]

## æ¦‚è¦

C++17 ã‹ã‚‰é›†æˆä½“åˆæœŸåŒ–ãŒæ‹¡å¼µã•ã‚Œã€åŸºåº•ã‚¯ãƒ©ã‚¹ã‚’æŒã¤å‹ã®åˆæœŸåŒ–ãŒç°¡æ½”ã«è¨˜è¿°ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚

## ä»•æ§˜

é›†æˆä½“åˆæœŸåŒ–ã«ãŠã„ã¦åŸºåº•ã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ã«ã¤ã„ã¦ã‚‚é›†æˆä½“åˆæœŸåŒ– `{ parameter1, parameter2, ... }` ã®æ§˜å¼ã§åŒæ§˜ã«å…¥ã‚Œåã«ã—ã¦è¨˜è¿°ã™ã‚‹ã€‚

## ä¾‹
```cpp example
#include <iostream>
#include <vector>
#include <string>

struct base_a { std::string s; };
struct base_b { double d; std::vector< int > vi; };
struct delived: base_a, base_b { char c; };

int main()
{
  // ã“ã®ã‚ˆã†ãªåˆæœŸåŒ–ã‚’ C++17 ä»¥é™ã¯æœ¬æ©Ÿèƒ½ã«ã‚ˆã‚Šä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸ
  // ã“ã®åˆæœŸåŒ–ã¯ C++14 ä»¥å‰ã§ã¯åŸºåº•ã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ã¨ã—ã¦æ‰±ãˆãšç¿»è¨³ã«å¤±æ•—ã—ã¦ã—ã¾ã†
  delived o
  { { // base_a; æœ¬æ©Ÿèƒ½ã«ã‚ˆã‚ŠåŸºåº•ã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ã‚’ { } ã§è¨˜è¿°ã§ãã‚‹
      "abc" // base_a::s
    }
  , { // base_b; æœ¬æ©Ÿèƒ½ã«ã‚ˆã‚ŠåŸºåº•ã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ã‚’ { } ã§è¨˜è¿°ã§ãã‚‹
      12.345 // base_b::d
    , { 1, 2, 3} // base_b::v
    }
  , 'd' // delived::c
  };
  
  std::cout 
    << "o.s = " << o.s << '\n'
    << "o.d = " << o.d << '\n'
    << "o.vi = "
    ;
  
  {
    using namespace std::literals::string_literals;
    auto separator = ""s;
    std:: cout << "[ ";
    for ( const auto& i : o.vi )
    {
      std::cout << separator << i;
      separator = ", "s;
    }
    std:: cout << " ]\n";
  }
  
  std::cout << "o.c = " << o.c << std::endl;
}
```

### å‡ºåŠ›
```
o.s = abc
o.d = 12.345
o.vi = [ 1, 2, 3 ]
o.c = d
```

## ã“ã®æ©Ÿèƒ½ãŒå¿…è¦ã«ãªã£ãŸèƒŒæ™¯ãƒ»çµŒç·¯
ã“ã®æ©Ÿèƒ½ãŒç„¡ã„ C++14 ã¾ã§ã¯ã€åŒæ§˜ã®äº‹ã‚’ã—ãŸã„å ´åˆã«ã¯åŸºåº•ã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ã‚‚å«ã‚ãŸã„æ´¾ç”Ÿå‹ã¸ã€åŸºåº•ã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ã‚‚è¡Œã†æ§‹ç¯‰åã‚’è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã£ãŸã€‚

```cpp example
// C++14 ã¾ã§ã®æ—§ã„ä»•æ§˜ã§åŒæ§˜ã®äº‹ã‚’ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«å¿…è¦ã ã£ãŸè¨˜è¿°
#include <iostream>

struct legacy_base
{
  // ã„ã¡ã„ã¡æ›¸ã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„ã®ã¯é¢å€’ãã•ã„
  legacy_base( int a_ ): a( a_ ) { }
  int a;
};
struct legacy_delived: legacy_base
{
  // ã„ã¡ã„ã¡æ›¸ã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„ã®ã¯é¢å€’ãã•ã„
  legacy_delived( int a_, int b_ ): legacy_base( a_ ), b( b_ ) { }
  int b;
};

int main()
{
  // åˆæœŸåŒ–ã‚’ç°¡æ½”ã«è¨˜è¿°ã™ã‚‹ãŸã‚ã«ã¯ legacy_delived, legacy_base ã®æ§‹ç¯‰åã«ä»•è¾¼ã¿ãŒå¿…è¦ã ã£ãŸ
  legacy_delived o{ 123, 456 };
  std::cout
    << "o.a = " << o.a << '\n'
    << "o.b = " << o.b << '\n'
    ;
}
```

ã“ã®ã‚ˆã†ãªé¢å€’ã‚’æœ¬æ©Ÿèƒ½ã«ã‚ˆã‚Šç°¡æ½”ã«è¨˜è¿°ã§ãã‚‹ã‚ˆã†ã«ã—ãŸã‹ã£ãŸã€‚

```cpp example
// C++17 ä»¥é™ã¯æœ¬æ©Ÿèƒ½ã«ã‚ˆã‚Š C++14 ã¾ã§ã®ã‚ˆã†ã«ä»•è¾¼ã¿ã‚’è¡Œã‚ãšã¨ã‚‚ç°¡æ½”ã«åŸºåº•ã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ã‚’è¨˜è¿°ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸ
#include <iostream>

struct legacy_base { int a; };
struct legacy_delived: legacy_base { int b; };

int main()
{
  legacy_delived o{ { 123 }, 456 };
  std::cout
    << "o.a = " << o.a << '\n'
    << "o.b = " << o.b << '\n'
    ;
}
```

ã“ã®æ©Ÿèƒ½ã«ã‚ˆã‚Š C++17 ä»¥é™ã§ã¯è¨˜è¿°ãŒç°¡æ½”ã«ãªã‚Šã€å®Ÿè£…åŠ´åŠ›ã®ä½æ¸›ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å¯èªæ€§ã®å‘ä¸ŠãŒå›³ã‚‰ã‚ŒãŸã€‚

## é–¢é€£é …ç›®

1. [C++14 / å®£è¨€æ™‚ã®ãƒ¡ãƒ³ãƒåˆæœŸåŒ–ã‚’æŒã¤å‹ã®é›†æˆä½“åˆæœŸåŒ–ã‚’è¨±å¯](../cpp14/brace_elision_in_array_temporary_initialization.md)


## å‚ç…§

1. [P0017R1 Extension to aggregate initialization](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0017r1.html)
